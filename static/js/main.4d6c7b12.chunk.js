(this.webpackJsonpmeettorrent=this.webpackJsonpmeettorrent||[]).push([[0],{115:function(e,t,n){},134:function(e,t){},136:function(e,t){},142:function(e,t){},143:function(e,t){},144:function(e,t){},148:function(e,t){},150:function(e,t){},155:function(e,t){},157:function(e,t){},168:function(e,t){},170:function(e,t){},179:function(e,t){},181:function(e,t){},188:function(e,t){},192:function(e,t){},194:function(e,t){},202:function(e,t){},204:function(e,t){},209:function(e,t){},210:function(e,t,n){},216:function(e,t,n){},217:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),o=n(106),i=n.n(o),a=n(17),u=n(37),s=n(5),j=(n(115),n(56)),f=n(58),b=n(57),d=n(36),l=n(19),O=n(53),h=n.n(O),p=n(107),v=n(108),g=n.n(v),x=n(40),m=n.n(x),y=n(109);function w(e){var t=new Uint8Array(e);return crypto.getRandomValues(t),Array.from(t).map((function(e){return e.toString(16).padStart(2,"0")})).join("")}n(210);var P=n(4),S=m.a.prototype._createPeer,k=w(20),C=new TextDecoder("utf-8");function E(){var e=Object(s.g)().meetingHash,t=Object(c.useState)({}),n=Object(a.a)(t,2),r=n[0],o=n[1],i=Object(c.useState)(),u=Object(a.a)(i,2),O=u[0],v=u[1],x=Object(c.useState)({}),w=Object(a.a)(x,2),E=w[0],I=w[1],D=Object(c.useState)(""),F=Object(a.a)(D,2),M=F[0],T=F[1],H=Object(c.useState)([]),J=Object(a.a)(H,2),L=J[0],A=J[1];return Object(c.useEffect)((function(){function e(){return(e=Object(p.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({audio:!0,video:{width:{ideal:1280},height:{ideal:720}}});case 3:return t=e.sent,v(t),e.abrupt("return",(function(){t.getTracks().forEach((function(e){return e.stop()}))}));case 8:e.prev=8,e.t0=e.catch(0),console.error("Error while getting media",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){if(O){m.a.prototype._createPeer=function(e){return S.call(this,Object(l.a)(Object(l.a)({},e),{},{stream:O}))};var t=new g.a({peerId:k,infoHash:e,announce:y.announceList});return t.on("peer",(function(e){console.log("Peer found",e),e.on("connect",(function(){console.log("New peer connected",e),o((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(d.a)({},e.id,e))}))})),e.on("close",(function(){console.log("Peer disconnected",e),I((function(t){var n=e.id;t[n];return Object(f.a)(t,[n].map(b.a))})),o((function(t){var n=e.id;t[n];return Object(f.a)(t,[n].map(b.a))}))})),e.on("error",(function(t){console.log("Peer error",t,e)})),e.on("data",(function(e){A((function(t){return[].concat(Object(j.a)(t),[C.decode(e)])}))})),e.on("stream",(function(t){console.log("Received stream",e,t),I((function(n){return Object(l.a)(Object(l.a)({},n),{},Object(d.a)({},e.id,t))}))}))})),t.start(),function(){t.stop()}}}),[e,O]),Object(P.jsxs)("div",{children:[Object(P.jsxs)("div",{children:["Meeting hash: ",e]}),Object(P.jsxs)("div",{children:["Peers connected: ",Object.keys(r).length+1]}),O&&Object(P.jsx)("video",{ref:function(e){var t;return e&&(null===(t=e.srcObject)||void 0===t?void 0:t.id)!==O.id&&(e.srcObject=O)},autoPlay:!0,playsInline:!0,controls:!1}),Object.values(E).map((function(e){return Object(P.jsx)("video",{ref:function(t){var n;return t&&(null===(n=t.srcObject)||void 0===n?void 0:n.id)!==e.id&&(t.srcObject=e)},autoPlay:!0,playsInline:!0,controls:!1},e.id)})),Object(P.jsxs)("form",{children:[Object(P.jsx)("input",{placeholder:"Message",value:M,onChange:function(e){return T(e.target.value)}}),Object(P.jsx)("button",{onClick:function(e){e.preventDefault(),Object.values(r).forEach((function(e){return e.send(M)})),A((function(e){return[].concat(Object(j.a)(e),[M])})),T("")},children:"Send"})]}),L.map((function(e,t){return Object(P.jsx)("div",{children:e},t)}))]})}var I=w(20);function D(){var e=Object(c.useState)(""),t=Object(a.a)(e,2),n=t[0],r=t[1];return Object(P.jsx)(u.a,{basename:"/meettorrent",children:Object(P.jsxs)(s.d,{children:[Object(P.jsxs)(s.b,{exact:!0,path:"/",children:[Object(P.jsx)(u.b,{to:"/".concat(I),children:"New meeting"}),Object(P.jsx)("input",{placeholder:"Past meeting hash",value:n,onChange:function(e){return r(e.target.value)}}),n&&Object(P.jsx)(u.b,{to:"/".concat(n),children:"Join"})]}),Object(P.jsx)(s.b,{path:"/:meetingHash([0-9a-f]{40})",children:Object(P.jsx)(E,{})}),Object(P.jsx)(s.b,{children:Object(P.jsx)(s.a,{to:"/"})})]})})}n(216);var F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,218)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),o(e),i(e)}))};i.a.render(Object(P.jsx)(r.a.StrictMode,{children:Object(P.jsx)(D,{})}),document.getElementById("root")),F()}},[[217,1,2]]]);
//# sourceMappingURL=main.4d6c7b12.chunk.js.map
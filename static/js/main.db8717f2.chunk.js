(this.webpackJsonpmeettorrent=this.webpackJsonpmeettorrent||[]).push([[0],{115:function(e,t,n){},134:function(e,t){},136:function(e,t){},142:function(e,t){},143:function(e,t){},144:function(e,t){},149:function(e,t){},151:function(e,t){},156:function(e,t){},157:function(e,t){},159:function(e,t){},170:function(e,t){},172:function(e,t){},181:function(e,t){},183:function(e,t){},190:function(e,t){},194:function(e,t){},196:function(e,t){},204:function(e,t){},206:function(e,t){},211:function(e,t){},212:function(e,t,n){},218:function(e,t,n){},219:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n.n(c),r=n(106),i=n.n(r),a=n(13),u=n(37),s=n(5),j=(n(115),n(56)),f=n(58),d=n(57),b=n(36),l=n(19),O=n(53),h=n.n(O),v=n(107),p=n(108),g=n.n(p),m=n(40),x=n.n(m),y=n(109);function w(e){var t=new Uint8Array(e);return crypto.getRandomValues(t),Array.from(t).map((function(e){return e.toString(16).padStart(2,"0")})).join("")}n(212);var S=n(4),P=x.a.prototype._createPeer,k=w(20),C=new TextDecoder("utf-8");function E(){var e=Object(s.g)().meetingHash,t=Object(c.useState)({}),n=Object(a.a)(t,2),o=n[0],r=n[1],i=Object(c.useState)(),u=Object(a.a)(i,2),O=u[0],p=u[1],m=Object(c.useState)({}),w=Object(a.a)(m,2),E=w[0],T=w[1],I=Object(c.useState)(""),M=Object(a.a)(I,2),D=M[0],F=M[1],H=Object(c.useState)([]),J=Object(a.a)(H,2),L=J[0],V=J[1];return Object(c.useEffect)((function(){function e(){return(e=Object(v.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({audio:!0,video:{width:{ideal:1280},height:{ideal:720}}});case 3:return t=e.sent,p(t),e.abrupt("return",(function(){t.getTracks().forEach((function(e){return e.stop()}))}));case 8:e.prev=8,e.t0=e.catch(0),console.error("Error while getting media",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){if(O){x.a.prototype._createPeer=function(e){return P.call(this,Object(l.a)(Object(l.a)({},e),{},{stream:O}))};var t=new g.a({peerId:k,infoHash:e,announce:y.announceList});return t.on("peer",(function(e){console.log("Peer found",e),e.on("connect",(function(){console.log("New peer connected",e),r((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(b.a)({},e.id,e))}))})),e.on("close",(function(){console.log("Peer disconnected",e),T((function(t){var n=e.id;t[n];return Object(f.a)(t,[n].map(d.a))})),r((function(t){var n=e.id;t[n];return Object(f.a)(t,[n].map(d.a))}))})),e.on("error",(function(t){console.log("Peer error",t,e)})),e.on("data",(function(e){V((function(t){return[].concat(Object(j.a)(t),[C.decode(e)])}))})),e.on("stream",(function(t){console.log("Received stream",e,t),T((function(n){return Object(l.a)(Object(l.a)({},n),{},Object(b.a)({},e.id,t))}))}))})),t.start(),function(){t.stop()}}}),[e,O]),Object(S.jsxs)("div",{children:[Object(S.jsxs)("div",{children:["Meeting hash: ",e]}),Object(S.jsxs)("div",{children:["Peers connected: ",Object.keys(o).length+1]}),O&&Object(S.jsx)("video",{ref:function(e){var t,n;if(e){var c=O.getVideoTracks(),o=Object(a.a)(c,1)[0],r=null!==(t=null===(n=e.srcObject)||void 0===n?void 0:n.getVideoTracks())&&void 0!==t?t:[void 0],i=Object(a.a)(r,1)[0];o.id!==(null===i||void 0===i?void 0:i.id)&&(e.srcObject=new MediaStream([o]))}},autoPlay:!0,playsInline:!0,controls:!1}),Object.values(E).map((function(e){return Object(S.jsx)("video",{ref:function(t){var n;return t&&(null===(n=t.srcObject)||void 0===n?void 0:n.id)!==e.id&&(t.srcObject=e)},autoPlay:!0,playsInline:!0,controls:!1},e.id)})),Object(S.jsxs)("form",{children:[Object(S.jsx)("input",{placeholder:"Message",value:D,onChange:function(e){return F(e.target.value)}}),Object(S.jsx)("button",{onClick:function(e){e.preventDefault(),Object.values(o).forEach((function(e){return e.send(D)})),V((function(e){return[].concat(Object(j.a)(e),[D])})),F("")},children:"Send"})]}),L.map((function(e,t){return Object(S.jsx)("div",{children:e},t)}))]})}var T=w(20);function I(){var e=Object(c.useState)(""),t=Object(a.a)(e,2),n=t[0],o=t[1];return Object(S.jsx)(u.a,{basename:"/meettorrent",children:Object(S.jsxs)(s.d,{children:[Object(S.jsxs)(s.b,{exact:!0,path:"/",children:[Object(S.jsx)(u.b,{to:"/".concat(T),children:"New meeting"}),Object(S.jsx)("input",{placeholder:"Past meeting hash",value:n,onChange:function(e){return o(e.target.value)}}),n&&Object(S.jsx)(u.b,{to:"/".concat(n),children:"Join"})]}),Object(S.jsx)(s.b,{path:"/:meetingHash([0-9a-f]{40})",children:Object(S.jsx)(E,{})}),Object(S.jsx)(s.b,{children:Object(S.jsx)(s.a,{to:"/"})})]})})}n(218);var M=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,220)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),o(e),r(e),i(e)}))};i.a.render(Object(S.jsx)(o.a.StrictMode,{children:Object(S.jsx)(I,{})}),document.getElementById("root")),M()}},[[219,1,2]]]);
//# sourceMappingURL=main.db8717f2.chunk.js.map